<!DOCTYPE html>
<html lang="en">
<head>
  <!-- <meta charset="UTF-8"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
 <link rel="stylesheet" href="style.css">
 <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

 <style>
    .text-center {
        text-align: center;
        margin-top: 20px;
    }

    .btn-custom {
        background-color: #0056b3; 
        color: #ffffff; 
        border: 2px solid #ffffff; 
        padding: 12px 24px; 
        font-size: 18px; 
        font-weight: bold; 
        text-transform: uppercase; 
        border-radius: 8px; 
        cursor: pointer;
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2); 
        transition: all 0.3s ease;
    }
  
    .btn-custom:hover {
        background-color: #004080; 
        color: #ffc107; 
        border: 2px solid #ffc107; 
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3); 
        transform: translateY(-2px); 
    }
  
    .btn-custom:active {
        background-color: #003366; 
        color: #adb5bd; 
        border: 2px solid #adb5bd; 
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); 
        transform: translateY(0);
    }

    .feedback-section {
      background-color:#ffc107a8;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      padding: 15px;
      border-radius: 5px;
    }

    .feedback-section:hover {
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4);
    }
        h1 {
            
            margin-bottom: 30px;
        }
        /* footer part */

        .info-section {
            background-color: rgba(0, 0, 0, 0.471);
            color: white;
            padding: 40px 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        .info-section h3 {
            margin-bottom: 20px;
        }
        .info-section p, .info-section a {
            color: white;
        }
        .info-section a:hover {
            text-decoration: none;
        }
        .footer {
            background-color: #0056b3;
            color: white;
            padding: 10px 0;
            margin-top: 20px;
        }
        iframe {
            border-radius: 10px;
        }

      .link{
          text-decoration: none;
          font-size: 25px;  
        }

        .link:hover{
          color:#1f318e
        }
        .foot{
          color: blue;
          font-size: 35px;
        }

        /* navbar */
        .navbar-nav .nav-link:hover {
        background-color: blue !important;
        border-radius:5px ;
        }

        .head{
          font-weight: bolder;
          font-size: 40px;
          text-shadow:0px 3px 2px gray;
         
        }

        .logo{
        height: 40px;
          width: 100px;
          cursor: pointer;
          padding-right: 7px;
        }

        .feedback{
          background-color: #1e5186b3;
        }

    .card {
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .card-body {
      background-color: #d3eafc47; /* Light blue background */
    }

  </style>
  
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container-fluid">
        
         <img src="images.png" alt="" class="logo">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="User.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">About Us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="Ticket.html">New Ticket</a>
            </li>
          </ul>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="Login.html">Login</a>
            </li>
            <li class="nav-item bg-primary">
              <a class="nav-link active bg-primary" aria-current="page" href="profile1.html">Profile</a>
            </li>
            <li class="nav-item">
              <button class="btn btn-primary" onclick="logout()">Logout</button>
            </li>
          </ul>
        </div>
      </div>
    </nav>
   

  <div class="container-fluid">
    <h1 class="my-5 text-center head">Ticket Management System</h1>
    <div class="row text-center justify-content-center">
      <div class="col-sm-3">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title" style="background-color: #184ee3a9">Open Tickets</h5>
            <p class="card-text" id="open">0</p>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title" style="background-color: #184ee3a9">Closed Tickets</h5>
            <p class="card-text" id="closed">0</p>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title" style="background-color: #184ee3a9">In Progress</h5>
            <p class="card-text" id="inprogress">0</p>
          </div>
        </div>
      </div>
      <div class="col-sm-3">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title" style="background-color: #184ee3a9">All Tickets</h5>
            <p class="card-text" id="alltickets">0</p>
          </div>
        </div>
      </div>
     
    </div>
  </div>
  <div class="text-center">
    <a class="btn btn-custom" href="Ticket.html" role="button">New Ticket</a>
</div>
    <div class="row my-5">
      <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title text-center" style="background-color: #184ee3a9">Unresolved Tickets by Priority</h5>
                <div class="chart-container">
                    <canvas id="priorityChart"></canvas>
                </div>
            </div>
        </div>
    </div>
      <div class="col-md-4">
        <div class="card">
          <div class="card-body">
            <div style="background-color: #184ee3a9">
                <h5 class="card-title text-center">Unresolved Tickets by Status</h5>
            </div>
            
            <p class="card-title">Open</p>
            <div class="progress" id="openProgress" role="progressbar" aria-label="Open" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
              <div class="progress-bar" id="openProgressBar" style="width: 0%; background-color: #36A2EB;">0</div>
            </div>
            <p class="card-title">In Progress</p>
            <div class="progress" id="InProgress" role="progressbar" aria-label="InOpen" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
              <div class="progress-bar" id="InProgressBar" style="width: 0%; background-color: #36A2EB;">0</div>
            </div>
            <p class="card-title">Closed</p>
            <div class="progress" id="closedProgress" role="progressbar" aria-label="Closed" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
              <div class="progress-bar" id="closedProgressBar" style="width: 0%; background-color: #FFCE56;">0</div>
            </div>
            <p class="card-title">Total Tickets</p>
            <div class="progress" id="totalProgress" role="progressbar" aria-label="totalTickets" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
              <div class="progress-bar" id="totalProgressBar" style="width: 0%; background-color: #36A2EB;">0</div>
            </div>    
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title text-center" style="background-color: #184ee3a9">New & Open Tickets Category-wise</h5>
                <p class="card-title">Network</p>
                <div class="progress" id="networkProgress" role="progressbar" aria-label="Network" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" id="networkProgressBar" style="width: 0%; background-color: #36A2EB;">0</div>
                </div>
                <p class="card-title">Software</p>
                <div class="progress" id="softwareProgress" role="progressbar" aria-label="Software" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" id="softwareProgressBar" style="width: 0%; background-color: #FFCE56;">0</div>
                </div>
                <p class="card-title">Other</p>
                <div class="progress" id="otherProgress" role="progressbar" aria-label="Other" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" id="otherProgressBar" style="width: 0%; background-color: #36A2EB;">0</div>
                </div>
                <p class="card-title">Hardware</p>
                <div class="progress" id="hardwareProgress" role="progressbar" aria-label="Hardware" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                    <div class="progress-bar" id="hardwareProgressBar" style="width: 0%; background-color: #FF6384;">0</div>
                </div>
            </div>
        </div>
    </div>

    </div>

    <!-- Feedback  -->
    <div class="feedback">
    <div class="container">
        <div class="row text-center justify-content-between">
            <h1 class="text-center col-12">Feedback From Users</h1>
            <div class="col-md-2 text-center feedback-section mb-4">
                <p>"When I first submitted my ticket, I received an automated response immediately, which was reassuring. However, I had to follow up twice before I got a human response. Once the agent responded, the process was smooth, and my issue was resolved quickly."</p>
                <h4>Mohan</h4>
                <p>Gurugram, Haryana</p>
            </div>
            <div class="col-md-2 text-center feedback-section mb-4">
                <p>"When I first submitted my ticket, I received an automated response immediately, which was reassuring. However, I had to follow up twice before I got a human response. Once the agent responded, the process was smooth, and my issue was resolved quickly."</p>
                <h4>Mohan</h4>
                <p>Gurugram, Haryana</p>
            </div>
            <div class="col-md-2 text-center feedback-section mb-4">
                <p>"When I first submitted my ticket, I received an automated response immediately, which was reassuring. However, I had to follow up twice before I got a human response. Once the agent responded, the process was smooth, and my issue was resolved quickly."</p>
                <h4>Mohan</h4>
                <p>Gurugram, Haryana</p>
            </div>
            <div class="col-md-2 text-center feedback-section mb-4">
                <p>"When I first submitted my ticket, I received an automated response immediately, which was reassuring. However, I had to follow up twice before I got a human response. Once the agent responded, the process was smooth, and my issue was resolved quickly."</p>
                <h4>Mohan</h4>
                <p>Gurugram, Haryana</p>
            </div>
        </div>
    </div>
    </div>
    
    <!-- footer -->

    <div class="info-section ">
        <div class="row">
            <div class="col-md-4 text-center mb-4">
                <h3 class="foot">About Us</h3>
                <p class="" style="font-size: 20px;">Lorem ipsum, dolor sit amet consectetur adipisicing elit. Voluptates, architecto possimus dolorem quaerat iusto error modi tenetur voluptatem eos quidem temporibus exercitationem optio, fugiat facere. Reprehenderit neque nostrum asperiores. Aperiam.</p>
            </div>
            <div class="col-md-4 text-center mb-4">
                <h3 class="foot">Contact Us</h3>
                <a href="#" class="link">Instagram</a> <br>
                <a href="#" class=" link">Email</a> <br>
                <a href="#" class=" link">Facebook</a> <br>
                <a href="#" class="link">Twitter</a>
            </div>
            <div class="col-md-4 text-center mb-4">
                <h3 class="foot">Address</h3>
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3502.6105039049226!2d77.091957774956!3d28.61145938503835!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x390d1b532cfc9d91%3A0xb4ef201bfcc8c7fe!2sJanak%20Cinema%20Complex%2C%20Pankha%20Rd%2C%20Block%20C%206A%2C%20Janakpuri%2C%20Delhi%2C%20110058!5e0!3m2!1sen!2sin!4v1720007516312!5m2!1sen!2sin" width="350" height="200" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
    </div>
    <div class="text-center footer">
        <p>All Rights Reserved @2024</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>

      document.addEventListener("DOMContentLoaded", function() {
          fetch("https://localhost:7246/api/Ticket/getTickets")
              .then(response => {
                  if (!response.ok) {
                      throw new Error('Network response was not ok');
                  }
                  return response.json();
              })
              .then(data => {
                  console.log('Data fetched from API:', data);
  
                  // Initialize counts for each category and priority level
                  let networkCount = 0;
                  let softwareCount = 0;
                  let otherCount = 0;
                  let hardwareCount = 0;
                  let highCount = 0;
                  let mediumCount = 0;
                  let lowCount = 0;
                  let open=0;
                  let InProgess=0;
                  let closed=0;
  
                  // Count tickets in each category and by priority
                  data.forEach(ticket => {
                      switch (ticket.category) {
                          case 'Network':
                              networkCount++;
                              break;
                          case 'Software':
                              softwareCount++;
                              break;
                          case 'Other':
                              otherCount++;
                              break;
                          case 'Hardware':
                              hardwareCount++;
                              break;
                      }
  
                      switch (ticket.priority) {
                          case 'high':
                              highCount++;
                              break;
                          case 'medium':
                              mediumCount++;
                              break;
                          case 'low':
                              lowCount++;
                              break;
                      }
                      switch(ticket.userName){
                        case 'Open':
                          open++;
                          break;
                        case 'In Progress':
                          InProgess++;
                          break;
                        case 'Closed':
                          closed++;
                          break;
                      }
                      
                  });

                  // Calculate total tickets for percentage calculations
                  var totalTickets = networkCount + softwareCount + otherCount + hardwareCount;
  
                  
                  // Calculate percentage values
                  var networkPercent = (networkCount / totalTickets) * 100;
                  var softwarePercent = (softwareCount / totalTickets) * 100;
                  var otherPercent = (otherCount / totalTickets) * 100;
                  var hardwarePercent = (hardwareCount / totalTickets) * 100; 
                  var openPercent=(open/totalTickets)*100;
                  var InprogressPercent=(InProgess/totalTickets)*100;
                  var closePercent=(closed/totalTickets)*100;


                  console.log(`Network: ${networkCount} (${networkPercent}%)`);
                  console.log(`Software: ${softwareCount} (${softwarePercent}%)`);
                  console.log(`Other: ${otherCount} (${otherPercent}%)`);
                  console.log(`Hardware: ${hardwareCount} (${hardwarePercent}%)`);
                  
                  console.log(`Closed: ${closed} (${closePercent}%)`);
                  // Update progress bars
                                    
                  document.getElementById('networkProgressBar').style.width = networkPercent + '%';
                  document.getElementById('networkProgressBar').textContent = networkCount;
  
                  document.getElementById('softwareProgressBar').style.width = softwarePercent + '%';
                  document.getElementById('softwareProgressBar').textContent = softwareCount;
  
                  document.getElementById('otherProgressBar').style.width = otherPercent + '%';
                  document.getElementById('otherProgressBar').textContent = otherCount;
  
                  document.getElementById('hardwareProgressBar').style.width = hardwarePercent + '%';
                  document.getElementById('hardwareProgressBar').textContent = hardwareCount;

                  document.getElementById('totalProgressBar').style.width=totalTickets+'%';
                  document.getElementById('totalProgressBar').textContent=totalTickets;

                  document.getElementById('openProgressBar').style.width=openPercent+'%';
                  document.getElementById('openProgressBar').textContent=open;

                  document.getElementById('InProgressBar').style.width=InprogressPercent  +'%';
                  document.getElementById('InProgressBar').textContent=InProgess;

                  document.getElementById('closedProgressBar').style.width=closePercent+'%';
                  document.getElementById('closedProgressBar').textContent=closed;

                  document.getElementById('alltickets').innerHTML=totalTickets;
                  document.getElementById('open').innerHTML=open;
                  document.getElementById('closed').innerHTML=closed;
                  document.getElementById('inprogress').innerHTML=InProgess;
  
                  // Update the doughnut chart with the new data
                  var ctxPriority = document.getElementById('priorityChart').getContext('2d');
                  var priorityChart = new Chart(ctxPriority, {
                      type: 'doughnut',
                      data: {
                          labels: ['High', 'Medium', 'Low'],
                          datasets: [{
                              data: [highCount, mediumCount, lowCount],
                              backgroundColor: ['#FF6384', '#FFCE56', '#36A2EB'],
                          }]
                      },
                      options: {
                          responsive: true,
                          maintainAspectRatio: false
                      }
                  });
              })
              .catch(error => console.error('Error fetching data:', error));
      });
      
      function logout() {
            // Clear localStorage
            localStorage.removeItem('authToken');
            // Clear sessionStorage
            sessionStorage.removeItem('authToken');
            
            // Clear cookies
            document.cookie.split(";").forEach((c) => {
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
            });

            // Redirect to login page
            window.location.href = 'Login.html';
        }

  </script>
  
    
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<!--Start of Tawk.to Script-->
<script type="text/javascript">

  var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
  (function(){
  var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
  s1.async=true;
  s1.src='https://embed.tawk.to/66877a44eaf3bd8d4d18450b/1i20jbbbb';
  s1.charset='UTF-8';
  s1.setAttribute('crossorigin','*');
  s0.parentNode.insertBefore(s1,s0);
  })();
  </script>

  <!--End of Tawk.to Script-->

</body>
</html>
